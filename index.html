<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Administrador de Citas Veterinaria</title>

<!-- Bootstrap -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

<!-- SweetAlert -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<style>
body{
    background:#f2f5f8;
}

.header{
    background:#198754;
    color:white;
}

.card-cita{
    border-radius:15px;
    transition:.25s;
}

.card-cita:hover{
    transform:scale(1.02);
}

.pet-img{
    height:110px;
    object-fit:contain;
}

.animales{
    font-size:20px;
}

textarea{
    resize:none;
}
</style>
</head>

<body>

<!-- ================= HEADER ================= -->
<div class="header p-3 shadow">
<div class="container d-flex justify-content-between align-items-center">
<h4 class="m-0">ğŸ¾ Administrador de Citas</h4>
<button class="btn btn-light" data-bs-toggle="modal" data-bs-target="#modal">
+ Nueva cita
</button>
</div>
</div>


<!-- ================= CONTENIDO ================= -->
<div class="container mt-4">

<select id="filtroEstado" onchange="filtrar()" class="form-select w-25 mb-3">
<option value="Todas">Todas</option>
<option value="Abierta">Abierta</option>
<option value="Terminada">Terminada</option>
<option value="Anulada">Anulada</option>
</select>

<div id="contenedor" class="row g-3"></div>

</div>



<!-- ================= MODAL ================= -->
<div class="modal fade" id="modal">
<div class="modal-dialog modal-lg">
<div class="modal-content">

<div class="modal-header bg-success text-white">
<h5>Nueva Cita</h5>
<button class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
</div>

<div class="modal-body">

<div class="row g-3">

<input id="nombre" class="form-control col-md-6" placeholder="Nombre mascota">
<input id="propietario" class="form-control col-md-6" placeholder="Propietario">
<input id="telefono" type="number" class="form-control col-md-6" placeholder="TelÃ©fono">

<select id="tipo" class="form-select col-md-6">
<option value="">Tipo de mascota</option>
<option>ğŸ¶ Perro</option>
<option>ğŸ± Gato</option>
<option>ğŸ° Conejo</option>
<option>ğŸ¹ HÃ¡mster</option>
<option>ğŸ¦ Ave</option>
<option>ğŸ¢ Tortuga</option>
<option>ğŸ  Pez</option>
<option>ğŸ´ Caballo</option>
<option>ğŸ® Vaca</option>
<option>ğŸ· Cerdo</option>
</select>

<input id="fecha" type="date" class="form-control col-md-6">
<input id="hora" type="time" class="form-control col-md-6">

<textarea id="sintomas" rows="3" class="form-control" placeholder="SÃ­ntomas"></textarea>

</div>

</div>

<div class="modal-footer">
<button class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
<button class="btn btn-success" onclick="guardar()">Guardar</button>
</div>

</div>
</div>
</div>



<!-- ================= SCRIPTS ================= -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<script>

let citas=[];


// ================= TOAST =================
const Toast = Swal.mixin({ //crea una plantillla especializada para no repetir codigp
toast:true, //transforma la alerta en una notificacion pequeÃ±a y discreta
position:'top-end',//nome la notficacion arriba a la derecha
showConfirmButton:false,//qyuta el boton de ok para que el usuario no tenga que cerrarla manualmente
timer:2200,
timerProgressBar:true
});

function noti(msg,icon="error"){
Toast.fire({icon,title:msg});
}


// ================= VALIDACIONES =================
function validar(){

if(!nombre.value.trim()){
noti("Ingrese nombre de mascota"); return false;
}

if(!propietario.value.trim()){
noti("Ingrese propietario"); return false;
}

if(!telefono.value.trim()){
noti("Ingrese telÃ©fono"); return false;
}

if(!tipo.value){
noti("Seleccione tipo de animal"); return false;
}

if(!sintomas.value.trim()){
noti("Describa sÃ­ntomas"); return false;
}

const hoy=new Date();
hoy.setHours(0,0,0,0);

if(!fecha.value || new Date(fecha.value)<=hoy){
noti("Fecha debe ser posterior a hoy"); return false;
}

const h=parseInt(hora.value.split(":")[0]);

if(!hora.value || h<8 || h>=20){
noti("Horario permitido 8am - 8pm"); return false;
}

return true;
}


// ================= GUARDAR =================
function guardar(){

if(!validar()) return;

const cita={
id:Date.now(),
nombre:nombre.value,
propietario:propietario.value,
telefono:telefono.value,
tipo:tipo.value,
fecha:fecha.value,
hora:hora.value,
sintomas:sintomas.value,
estado:"Abierta"
};

citas.push(cita);

render();

noti("Cita guardada correctamente","success");

bootstrap.Modal.getInstance(modal).hide();
}


// ================= IMAGENES POR TIPO =================
const imagenes = {
"ğŸ¶ Perro":"img/perro.gif",
"ğŸ± Gato":"img/gato.gif",
"ğŸ° Conejo":"img/conejo.gif",
"ğŸ¹ HÃ¡mster":"img/hamster.gif",
"ğŸ¦ Ave":"img/pajaro.gif",
"ğŸ¢ Tortuga":"img/tortuga.gif",
"ğŸ  Pez":"img/pez.gif",
"ğŸ´ Caballo":"img/caballo.gif",
"ğŸ® Vaca":"img/vaca.gif",
"ğŸ· Cerdo":"img/cerdo.gif"
};


// ================= RENDER =================
function render(){

contenedor.innerHTML="";

citas.forEach(c=>{

const img = imagenes[c.tipo];

contenedor.innerHTML+=`
<div class="col-md-6 col-lg-4 card-cita" data-estado="${c.estado}">
<div class="card shadow p-3">

<div class="row">

<div class="col-4 text-center">
<img src="${img}" class="w-100 pet-img">
</div>

<div class="col-8">
<h6><b>${c.nombre}</b></h6>
<small>${c.tipo}</small><br>
<small>ğŸ‘¤ ${c.propietario}</small><br>
<small>ğŸ“… ${c.fecha} ${c.hora}</small>

<select class="form-select mt-1" onchange="c.estado=this.value">
<option ${c.estado=="Abierta"?"selected":""}>Abierta</option>
<option ${c.estado=="Terminada"?"selected":""}>Terminada</option>
<option ${c.estado=="Anulada"?"selected":""}>Anulada</option>
</select>

<button class="btn btn-danger btn-sm mt-2 w-100" onclick="eliminar(${c.id})">Eliminar</button>
</div>

</div>

<hr>

<div>${c.sintomas}</div>

<div class="animales text-center mt-2">
ğŸ¶ ğŸ± ğŸ° ğŸ¹ ğŸ¦ ğŸ¢ ğŸ  ğŸ´ ğŸ® ğŸ·
</div>

</div>
</div>
`;
});

filtrar();
}


// ================= FILTRO =================
function filtrar(){
document.querySelectorAll(".card-cita").forEach(card=>{
card.style.display=(filtroEstado.value==="Todas"||card.dataset.estado===filtroEstado.value)?"block":"none";
});
}


// ================= ELIMINAR =================
function eliminar(id){
Swal.fire({
title:"Â¿Eliminar cita?",
icon:"warning",
showCancelButton:true
}).then(r=>{
if(r.isConfirmed){
citas=citas.filter(c=>c.id!==id);
render();
}
});
}

</script>

</body>
</html>
